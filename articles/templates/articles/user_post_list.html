{% extends 'base.html' %}
{% block title %}{{ user }} post list{% endblock %}
{% block content %}

<div class="profile-bg">
    <div class="background-img">

    </div>
</div>

<div class="profile-description">
    <a href="{% url 'accounts:profile_detail' user %}">
        <img src="{{ user.profile.image.url }}" alt="{{ user.username }} Avatar" loading="lazy">
    </a>
    <a href="{% url 'accounts:profile_detail' user %}" class="edit">フォローする</a>
    <div class="profile-name">
    {{ user.username }}
    </div>
    <div class="profile-bio">
    {% if user.profile.bio %}
        {{ user.profile.bio }}
    {% endif %}
    </div>
    <div class="profile-website">
        <i class="fas fa-link"></i>
        {% if user.profile.website %}
        <a href="{{ user.profile.website }}">
            {{ user.profile.website }}
        </a>
        {% endif %}
    </div>
    <div class="info-wrapper">
        <ul class="info-box">
            <li class="following-info">
                <strong>{{ user.is_following.all.count }}</strong>
                <span>フォロー中</span>
            </li>
            <li class="followers-info">
                <strong>{{ user.profile.followers.all.count }}</strong>
                <span>フォロワー</span>
            </li>
        </ul>
    </div>
</div>

<div class="container-all-post">
    <section class="listPost">
        {% for article in articles %}
        {% if article.thumb != 'No-image.png' %}
        <a href="{% url 'articles:detail' detail_id=article.id %}" class="articles-post">
            <div class="post-image">
                <img src="{{ article.thumb.url }}" alt="{{ article.title }}" loading="lazy"/>
            </div>
            <div class="overlay">
                <span>
                    <i class="far fa-heart"></i>
                    {% if article.total_likes %}
                    {{ article.total_likes }}
                    {% endif %}
                </span>
                <span>
                    <i class="far fa-comment"></i>
                    {% if article.comments.count %}
                    {{ article.comments.count }}
                    {% endif %}
                </span>
            </div>
        </a>
        {% endif %}
        {% endfor %}
    </section>
</div>

{% if is_paginated %}
<div class="pager">
    <ul class="pagination">
    {% if page_obj.has_previous %}
        <li class="pre"><a class="active" href="?page=1"><span>
            <i class="fa fa-angle-double-left" aria-hidden="true"></i></span>
        </a></li>
        <li class="pre"><a class="active" href="?page={{ page_obj.previous_page_number }}"><span>
            <i class="fa fa-angle-left" aria-hidden="true"></i></span>
        </a></li>
    {% endif %}

    {% for num in paginator.page_range %}
        {% if page_obj.number == num %}
            <li><a class="active" href="#"><span>{{ num }}</span></a></li>
        {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
        <li><a href="?page={{ num }}"><span>{{ num }}</span></a></li>
        {% endif %}
    {% endfor %}

    {% if page_obj.has_next %}
        <li class="next"><a href="?page={{page_obj.next_page_number }}"><span>
            <i class="fa fa-angle-right" aria-hidden="true"></i></span>
        </a></li>
        <li class="next"><a href="?page={{ page_obj.paginator.num_pages }}"><span>
            <i class="fa fa-angle-double-right" aria-hidden="true"></i></span>
        </a></li>
    {% endif %}
    </ul>
</div>
{% endif %}

{% endblock %}